# Pipeline 2.0 Configuration
# Frågedriven Smart Block Factory

paths:
  # Input
  secondary_input: "data_pipeline/input/secondary"  # 180 avrop (bränsle)
  primary_fulldocs: "storage/lake"  # FULL_DOCUMENTs (källa för svar)
  
  # Output
  output_lake: "storage/lake"
  output_index: "storage/index"
  
  # Config
  document_registry: "data_pipeline/config/document_registry.yaml"

api:
  # P-Bot endpoint för testing
  pbot_endpoint: "http://localhost:5000/api/conversation"

models:
  # LLM models
  extractor: "gemini-2.0-flash"      # Snabb för fråge-extraktion
  judge: "gemini-2.0-flash"          # Bedömer svar
  creator: "gemini-2.0-flash"        # Skapar Smart Blocks

throttle:
  # Adaptive throttler (samma som Pipeline 1.0)
  initial_concurrency: 5
  max_concurrency: 30
  min_concurrency: 1
  brake_factor: 0.5
  cooldown_seconds: 10

anonymization:
  # Giftiga fält som ska strippas
  toxic_patterns:
    - "\\b[A-Z][a-zåäö]+\\s+(kommun|region|myndighet|AB|Aktiebolag)\\b"  # Organisationer
    - "\\b[A-ZÅÄÖ][a-zåäö]+\\s+[A-ZÅÄÖ][a-zåäö]+\\b"  # Personnamn (grova)
    - "\\d{6}[-]?\\d{4}"  # Personnummer
    - "\\d{10}"  # Org.nummer
  
  # Processdata som behålls
  keep_patterns:
    - "FKU|Förnyad konkurrensutsättning"
    - "DR|Dynamisk rangordning"
    - "\\d{2}/\\d{2}|\\d{2}-\\d{2}"  # Viktningar (70/30)
    - "nivå\\s*[1-5]"
    - "\\d+\\s*timmar"

verdicts:
  # Judge-LLM output mapping
  correct: "OK"
  wrong: "IMPROVE"
  incomplete: "IMPROVE"
  no_sources: "GAP"

logging:
  level: "INFO"
  output_dir: "data_pipeline/logs"







